# Main Server of Spb-Alert-Task

## API
Tornado web сервер, который взаимодействует с другими микро-севисами нашего проекта.
Имеет один публичный метод `api.pushEvent`, который принимает объект сообщения о проишествии.
Далее, управление передается `Worker` сервису. По сути, это точка в хода в наш сервис, в который легко
можно добавить модули и взаимодействовать с ними через _http_ запросы.

## Event Worker
Tornado web сервер, который взаимодействует с микросервисом-агрегатором ML моделей. Внутри себя имеет
набор блокирующих очередей, которые со временем выгружают сообщения в ML сервис. Пайплайн:
* Сообщения опредленного типа кладутся в соответствующую очередь
* Через какой-то квант времени очередь очищается от старых сообщений
* "Протухшие" и "свежие" сообщения отправляются ML сервису
* ML сервис кластеризует сообщения и возвращает так же N сообщений с `id` кластера 
(`id` = -1, если сообщение не относится ни к какому кластеру)
* Формируются объект кластера
* Каждый кластер отправляется ML сервису, на опредление штатности инцидента
* При пометке кластера как нештатного, запрашивается метка причины инцедента
* Отправляется по _http_ UI сервису, который уже видит результат работы всего сервиса 